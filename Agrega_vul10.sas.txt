LIBNAME OUT 'C:\Projetos\RMs Proc. 03605.001726-2014-52 - FJP Maria Luiza Marques\Maceio\Vulnerabilidade\2010\Agregacoes';
LIBNAME IN 'C:\Projetos\RMs Proc. 03605.001726-2014-52 - FJP Maria Luiza Marques\Maceio\Vulnerabilidade\2010';

 OPTIONS PS=10000 NODATE LS=250 OBS=MAX;


DATA SETOR;
SET IN.vul10;




*** VULNERABILIDADE ***;
IF M10A14CF=. THEN M10A14CF=0;
IF M15A17CF=. THEN M15A17CF=0;
IF POPMU10A14=. THEN POPMU10A14=0;
IF POPMU15A17=. THEN POPMU15A17=0;
IF POPMU10M=. THEN POPMU10M=0;
IF MULCHEFEFUNDINFDOM=. THEN MULCHEFEFUNDINFDOM=0;
IF OCUPM15=. THEN OCUPM15=0;
IF POP10A14=. THEN POP10A14=0;
IF CRIFUNDIN_TODOS=. THEN CRIFUNDIN_TODOS=0;
IF POPM15=. THEN POPM15=0;
IF OCUP=. THEN OCUP=0;
IF FUNDIN_TODOS=. THEN FUNDIN_TODOS=0;
IF POP=. THEN POP=0;
IF NESTUDA_NTRAB_MMEIO=. THEN NESTUDA_NTRAB_MMEIO=0;
IF POP15A24=. THEN POP15A24=0;
IF FUNDIN18MINF=. THEN FUNDIN18MINF=0;
IF POP18M=. THEN POP18M=0;
IF FUNDIN_TODOS_MMEIO=. THEN FUNDIN_TODOS_MMEIO=0;
IF RMAXIDOSO=. THEN RMAXIDOSO=0;




/* IMPORTACAO DO ARQUIVO CONTENDO BASE MAE */
PROC IMPORT OUT= WORK.MAE_A
            DATAFILE= "C:\Projetos\RMs Proc. 03605.001726-2014-52 - FJP Maria Luiza Marques\Base_mae\Maceio\MAE10_M.txt"
            DBMS=TAB REPLACE;
     GETNAMES=YES;
     DATAROW=2;
RUN;



DATA MAE_A(KEEP=SETORC AGREG_UNIV10 UDH_IBGE10 Cod_Reg10 Mun10 Cod_RM10);
SET MAE_A;


SETORC=PUT(Setor_2010,15.);
AGREG_UNIV10=PUT(Agreg_Universo_2010,13.);


UDH_IBGE10=UDH_IBGE_2010;
Cod_Reg10=Cod_Regionais_2010;
Mun10=Cod_Mun_2010;
Cod_RM10=Cod_RM_2010;


PROC SORT DATA=MAE_A;
BY SETORC;


DATA SETOR;
MERGE SETOR(IN=A) MAE_A(IN=B);
IF A AND B;
BY SETORC;




******************************** CALCULANDO OS INDICADORES - UDH_IBGE_2010 ********************************;


PROC SORT DATA=SETOR;
BY UDH_IBGE10;



PROC MEANS DATA=SETOR SUM NOPRINT;
VAR M10A14CF M15A17CF POPMU10A14 POPMU15A17 POPMU10M MULCHEFEFUNDINFDOM OCUPM15 POP10A14 CRIFUNDIN_TODOS
    POPM15 OCUP FUNDIN_TODOS POP NESTUDA_NTRAB_MMEIO POP15A24 FUNDIN18MINF POP18M FUNDIN_TODOS_MMEIO RMAXIDOSO
    OCUPDESLOC_1 OCUPDESLOC_2 OCUP;
OUTPUT OUT=SOMA1 (KEEP=UDH_IBGE10 M10A14CF M15A17CF POPMU10A14 POPMU15A17 POPMU10M MULCHEFEFUNDINFDOM OCUPM15 POP10A14 CRIFUNDIN_TODOS
                       POPM15 FUNDIN_TODOS POP NESTUDA_NTRAB_MMEIO POP15A24 FUNDIN18MINF POP18M FUNDIN_TODOS_MMEIO RMAXIDOSO
                       OCUPDESLOC_1 OCUPDESLOC_2 OCUP)
       SUM=M10A14CF M15A17CF POPMU10A14 POPMU15A17 POPMU10M MULCHEFEFUNDINFDOM OCUPM15 POP10A14 CRIFUNDIN_TODOS
           POPM15 OCUP FUNDIN_TODOS POP NESTUDA_NTRAB_MMEIO POP15A24 FUNDIN18MINF POP18M FUNDIN_TODOS_MMEIO RMAXIDOSO
           OCUPDESLOC_1 OCUPDESLOC_2 OCUP;
BY UDH_IBGE10;



DATA FINAL;
SET SOMA1;




*** VULNERABILIDADE ***;

IF POPMU10A14>0 THEN T_M10A14CF=(M10A14CF/POPMU10A14)*100;
ELSE                 T_M10A14CF=0;

IF POPMU15A17>0 THEN T_M15A17CF=(M15A17CF/POPMU15A17)*100;
ELSE                 T_M15A17CF=0;

IF POPMU10M>0 THEN T_MULCHEFEFIF014=(MULCHEFEFUNDINFDOM/POPMU10M)*100;
ELSE               T_MULCHEFEFIF014=0;


IF POP10A14>0 THEN T_OCUPM15=(OCUPM15/POP10A14)*100;
ELSE               T_OCUPM15=0;

IF POPM15>0 THEN T_CRIFUNDIN_TODOS=(CRIFUNDIN_TODOS/POPM15)*100;
ELSE             T_CRIFUNDIN_TODOS=0;

IF POP>0 THEN T_FUNDIN_TODOS=(FUNDIN_TODOS/POP)*100;
ELSE          T_FUNDIN_TODOS=0;

IF POP15A24>0 THEN T_NESTUDA_NTRAB_MMEIO=(NESTUDA_NTRAB_MMEIO/POP15A24)*100;
ELSE               T_NESTUDA_NTRAB_MMEIO=0;

IF POP18M>0 THEN T_FUNDIN18MINF=(FUNDIN18MINF/POP18M)*100;
ELSE             T_FUNDIN18MINF=0;

IF POP>0 THEN T_FUNDIN_TODOS_MMEIO=(FUNDIN_TODOS_MMEIO/POP)*100;
ELSE          T_FUNDIN_TODOS_MMEIO=0;

IF POP>0 THEN T_RMAXIDOSO=(RMAXIDOSO/POP)*100;
ELSE          T_RMAXIDOSO=0;


IF OCUP>0 THEN T_OCUPDESLOC_1=(OCUPDESLOC_1/OCUP)*100;
ELSE           T_OCUPDESLOC_1=0;


IF OCUP>0 THEN T_OCUPDESLOC_2=(OCUPDESLOC_2/OCUP)*100;
ELSE           T_OCUPDESLOC_2=0;




*** GRAVACAO ***;

DATA OUT.VUL10_UDH_IBGE10;
SET FINAL;
RUN;


************************************;
*** IMPORTANDO A BASE PARA EXCEL ***;
************************************;

PROC DBLOAD DBMS=EXCEL DATA= OUT.VUL10_UDH_IBGE10;
PATH='C:\Projetos\RMs Proc. 03605.001726-2014-52 - FJP Maria Luiza Marques\Maceio\Vulnerabilidade\2010\Agregacoes
\VUL10_UDH_IBGE10.XLS';
PUTNAMES=YES;
LIMIT=0;
LOAD;



******************************** CALCULANDO OS INDICADORES - Cod_Regionais_2010 ********************************;


PROC SORT DATA=SETOR;
BY Cod_Reg10;



PROC MEANS DATA=SETOR SUM NOPRINT;
WHERE Cod_Reg10^=.;
VAR M10A14CF M15A17CF POPMU10A14 POPMU15A17 POPMU10M MULCHEFEFUNDINFDOM OCUPM15 POP10A14 CRIFUNDIN_TODOS
    POPM15 OCUP FUNDIN_TODOS POP NESTUDA_NTRAB_MMEIO POP15A24 FUNDIN18MINF POP18M FUNDIN_TODOS_MMEIO RMAXIDOSO
    OCUPDESLOC_1 OCUPDESLOC_2 OCUP;
OUTPUT OUT=SOMA1 (KEEP=Cod_Reg10 M10A14CF M15A17CF POPMU10A14 POPMU15A17 POPMU10M MULCHEFEFUNDINFDOM OCUPM15 POP10A14 CRIFUNDIN_TODOS
                       POPM15 FUNDIN_TODOS POP NESTUDA_NTRAB_MMEIO POP15A24 FUNDIN18MINF POP18M FUNDIN_TODOS_MMEIO RMAXIDOSO
                       OCUPDESLOC_1 OCUPDESLOC_2 OCUP)
       SUM=M10A14CF M15A17CF POPMU10A14 POPMU15A17 POPMU10M MULCHEFEFUNDINFDOM OCUPM15 POP10A14 CRIFUNDIN_TODOS
           POPM15 OCUP FUNDIN_TODOS POP NESTUDA_NTRAB_MMEIO POP15A24 FUNDIN18MINF POP18M FUNDIN_TODOS_MMEIO RMAXIDOSO
           OCUPDESLOC_1 OCUPDESLOC_2 OCUP;
BY Cod_Reg10;



DATA FINAL;
SET SOMA1;




*** VULNERABILIDADE ***;

IF POPMU10A14>0 THEN T_M10A14CF=(M10A14CF/POPMU10A14)*100;
ELSE                 T_M10A14CF=0;

IF POPMU15A17>0 THEN T_M15A17CF=(M15A17CF/POPMU15A17)*100;
ELSE                 T_M15A17CF=0;

IF POPMU10M>0 THEN T_MULCHEFEFIF014=(MULCHEFEFUNDINFDOM/POPMU10M)*100;
ELSE               T_MULCHEFEFIF014=0;


IF POP10A14>0 THEN T_OCUPM15=(OCUPM15/POP10A14)*100;
ELSE               T_OCUPM15=0;

IF POPM15>0 THEN T_CRIFUNDIN_TODOS=(CRIFUNDIN_TODOS/POPM15)*100;
ELSE             T_CRIFUNDIN_TODOS=0;

IF POP>0 THEN T_FUNDIN_TODOS=(FUNDIN_TODOS/POP)*100;
ELSE          T_FUNDIN_TODOS=0;

IF POP15A24>0 THEN T_NESTUDA_NTRAB_MMEIO=(NESTUDA_NTRAB_MMEIO/POP15A24)*100;
ELSE               T_NESTUDA_NTRAB_MMEIO=0;

IF POP18M>0 THEN T_FUNDIN18MINF=(FUNDIN18MINF/POP18M)*100;
ELSE             T_FUNDIN18MINF=0;

IF POP>0 THEN T_FUNDIN_TODOS_MMEIO=(FUNDIN_TODOS_MMEIO/POP)*100;
ELSE          T_FUNDIN_TODOS_MMEIO=0;

IF POP>0 THEN T_RMAXIDOSO=(RMAXIDOSO/POP)*100;
ELSE          T_RMAXIDOSO=0;


IF OCUP>0 THEN T_OCUPDESLOC_1=(OCUPDESLOC_1/OCUP)*100;
ELSE           T_OCUPDESLOC_1=0;


IF OCUP>0 THEN T_OCUPDESLOC_2=(OCUPDESLOC_2/OCUP)*100;
ELSE           T_OCUPDESLOC_2=0;




*** GRAVACAO ***;

DATA OUT.VUL10_Cod_Reg10;
SET FINAL;
RUN;


************************************;
*** IMPORTANDO A BASE PARA EXCEL ***;
************************************;

PROC DBLOAD DBMS=EXCEL DATA= OUT.VUL10_Cod_Reg10;
PATH='C:\Projetos\RMs Proc. 03605.001726-2014-52 - FJP Maria Luiza Marques\Maceio\Vulnerabilidade\2010\Agregacoes
\VUL10_Cod_Reg10.XLS';
PUTNAMES=YES;
LIMIT=0;
LOAD;



******************************** CALCULANDO OS INDICADORES - Cod_Mun_2010 ********************************;


PROC SORT DATA=SETOR;
BY Mun10;



PROC MEANS DATA=SETOR SUM NOPRINT;
VAR M10A14CF M15A17CF POPMU10A14 POPMU15A17 POPMU10M MULCHEFEFUNDINFDOM OCUPM15 POP10A14 CRIFUNDIN_TODOS
    POPM15 OCUP FUNDIN_TODOS POP NESTUDA_NTRAB_MMEIO POP15A24 FUNDIN18MINF POP18M FUNDIN_TODOS_MMEIO RMAXIDOSO
    OCUPDESLOC_1 OCUPDESLOC_2 OCUP;
OUTPUT OUT=SOMA1 (KEEP=Mun10 M10A14CF M15A17CF POPMU10A14 POPMU15A17 POPMU10M MULCHEFEFUNDINFDOM OCUPM15 POP10A14 CRIFUNDIN_TODOS
                       POPM15 FUNDIN_TODOS POP NESTUDA_NTRAB_MMEIO POP15A24 FUNDIN18MINF POP18M FUNDIN_TODOS_MMEIO RMAXIDOSO
                       OCUPDESLOC_1 OCUPDESLOC_2 OCUP)
       SUM=M10A14CF M15A17CF POPMU10A14 POPMU15A17 POPMU10M MULCHEFEFUNDINFDOM OCUPM15 POP10A14 CRIFUNDIN_TODOS
           POPM15 OCUP FUNDIN_TODOS POP NESTUDA_NTRAB_MMEIO POP15A24 FUNDIN18MINF POP18M FUNDIN_TODOS_MMEIO RMAXIDOSO
           OCUPDESLOC_1 OCUPDESLOC_2 OCUP;
BY Mun10;



DATA FINAL;
SET SOMA1;




*** VULNERABILIDADE ***;

IF POPMU10A14>0 THEN T_M10A14CF=(M10A14CF/POPMU10A14)*100;
ELSE                 T_M10A14CF=0;

IF POPMU15A17>0 THEN T_M15A17CF=(M15A17CF/POPMU15A17)*100;
ELSE                 T_M15A17CF=0;

IF POPMU10M>0 THEN T_MULCHEFEFIF014=(MULCHEFEFUNDINFDOM/POPMU10M)*100;
ELSE               T_MULCHEFEFIF014=0;


IF POP10A14>0 THEN T_OCUPM15=(OCUPM15/POP10A14)*100;
ELSE               T_OCUPM15=0;

IF POPM15>0 THEN T_CRIFUNDIN_TODOS=(CRIFUNDIN_TODOS/POPM15)*100;
ELSE             T_CRIFUNDIN_TODOS=0;

IF POP>0 THEN T_FUNDIN_TODOS=(FUNDIN_TODOS/POP)*100;
ELSE          T_FUNDIN_TODOS=0;

IF POP15A24>0 THEN T_NESTUDA_NTRAB_MMEIO=(NESTUDA_NTRAB_MMEIO/POP15A24)*100;
ELSE               T_NESTUDA_NTRAB_MMEIO=0;

IF POP18M>0 THEN T_FUNDIN18MINF=(FUNDIN18MINF/POP18M)*100;
ELSE             T_FUNDIN18MINF=0;

IF POP>0 THEN T_FUNDIN_TODOS_MMEIO=(FUNDIN_TODOS_MMEIO/POP)*100;
ELSE          T_FUNDIN_TODOS_MMEIO=0;

IF POP>0 THEN T_RMAXIDOSO=(RMAXIDOSO/POP)*100;
ELSE          T_RMAXIDOSO=0;


IF OCUP>0 THEN T_OCUPDESLOC_1=(OCUPDESLOC_1/OCUP)*100;
ELSE           T_OCUPDESLOC_1=0;


IF OCUP>0 THEN T_OCUPDESLOC_2=(OCUPDESLOC_2/OCUP)*100;
ELSE           T_OCUPDESLOC_2=0;




*** GRAVACAO ***;

DATA OUT.VUL10_Mun10;
SET FINAL;
RUN;


************************************;
*** IMPORTANDO A BASE PARA EXCEL ***;
************************************;

PROC DBLOAD DBMS=EXCEL DATA= OUT.VUL10_Mun10;
PATH='C:\Projetos\RMs Proc. 03605.001726-2014-52 - FJP Maria Luiza Marques\Maceio\Vulnerabilidade\2010\Agregacoes\VUL10_Mun10.XLS';
PUTNAMES=YES;
LIMIT=0;
LOAD;



******************************** CALCULANDO OS INDICADORES - Cod_RM_2010 ********************************;


PROC SORT DATA=SETOR;
BY Cod_RM10;



PROC MEANS DATA=SETOR SUM NOPRINT;
VAR M10A14CF M15A17CF POPMU10A14 POPMU15A17 POPMU10M MULCHEFEFUNDINFDOM OCUPM15 POP10A14 CRIFUNDIN_TODOS
    POPM15 OCUP FUNDIN_TODOS POP NESTUDA_NTRAB_MMEIO POP15A24 FUNDIN18MINF POP18M FUNDIN_TODOS_MMEIO RMAXIDOSO
    OCUPDESLOC_1 OCUPDESLOC_2 OCUP;
OUTPUT OUT=SOMA1 (KEEP=Cod_RM10 M10A14CF M15A17CF POPMU10A14 POPMU15A17 POPMU10M MULCHEFEFUNDINFDOM OCUPM15 POP10A14 CRIFUNDIN_TODOS
                       POPM15 FUNDIN_TODOS POP NESTUDA_NTRAB_MMEIO POP15A24 FUNDIN18MINF POP18M FUNDIN_TODOS_MMEIO RMAXIDOSO
                       OCUPDESLOC_1 OCUPDESLOC_2 OCUP)
       SUM=M10A14CF M15A17CF POPMU10A14 POPMU15A17 POPMU10M MULCHEFEFUNDINFDOM OCUPM15 POP10A14 CRIFUNDIN_TODOS
           POPM15 OCUP FUNDIN_TODOS POP NESTUDA_NTRAB_MMEIO POP15A24 FUNDIN18MINF POP18M FUNDIN_TODOS_MMEIO RMAXIDOSO
           OCUPDESLOC_1 OCUPDESLOC_2 OCUP;
BY Cod_RM10;



DATA FINAL;
SET SOMA1;




*** VULNERABILIDADE ***;

IF POPMU10A14>0 THEN T_M10A14CF=(M10A14CF/POPMU10A14)*100;
ELSE                 T_M10A14CF=0;

IF POPMU15A17>0 THEN T_M15A17CF=(M15A17CF/POPMU15A17)*100;
ELSE                 T_M15A17CF=0;

IF POPMU10M>0 THEN T_MULCHEFEFIF014=(MULCHEFEFUNDINFDOM/POPMU10M)*100;
ELSE               T_MULCHEFEFIF014=0;


IF POP10A14>0 THEN T_OCUPM15=(OCUPM15/POP10A14)*100;
ELSE               T_OCUPM15=0;

IF POPM15>0 THEN T_CRIFUNDIN_TODOS=(CRIFUNDIN_TODOS/POPM15)*100;
ELSE             T_CRIFUNDIN_TODOS=0;

IF POP>0 THEN T_FUNDIN_TODOS=(FUNDIN_TODOS/POP)*100;
ELSE          T_FUNDIN_TODOS=0;

IF POP15A24>0 THEN T_NESTUDA_NTRAB_MMEIO=(NESTUDA_NTRAB_MMEIO/POP15A24)*100;
ELSE               T_NESTUDA_NTRAB_MMEIO=0;

IF POP18M>0 THEN T_FUNDIN18MINF=(FUNDIN18MINF/POP18M)*100;
ELSE             T_FUNDIN18MINF=0;

IF POP>0 THEN T_FUNDIN_TODOS_MMEIO=(FUNDIN_TODOS_MMEIO/POP)*100;
ELSE          T_FUNDIN_TODOS_MMEIO=0;

IF POP>0 THEN T_RMAXIDOSO=(RMAXIDOSO/POP)*100;
ELSE          T_RMAXIDOSO=0;


IF OCUP>0 THEN T_OCUPDESLOC_1=(OCUPDESLOC_1/OCUP)*100;
ELSE           T_OCUPDESLOC_1=0;


IF OCUP>0 THEN T_OCUPDESLOC_2=(OCUPDESLOC_2/OCUP)*100;
ELSE           T_OCUPDESLOC_2=0;




*** GRAVACAO ***;

DATA OUT.VUL10_Cod_RM10;
SET FINAL;
RUN;


************************************;
*** IMPORTANDO A BASE PARA EXCEL ***;
************************************;

PROC DBLOAD DBMS=EXCEL DATA= OUT.VUL10_Cod_RM10;
PATH='C:\Projetos\RMs Proc. 03605.001726-2014-52 - FJP Maria Luiza Marques\Maceio\Vulnerabilidade\2010\Agregacoes
\VUL10_Cod_RM10.XLS';
PUTNAMES=YES;
LIMIT=0;
LOAD;


RUN;
